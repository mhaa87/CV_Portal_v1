<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="sidebarStyle.css">
    <link rel="stylesheet" href="cvStyle.css">
    <link rel="stylesheet" href="topbarStyle.css">
    <link rel="stylesheet" href="loginStyle.css">
    <link rel="stylesheet" href="leftMenu.css">
    <script src="vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>Dynamisk CV</title>
</head>

<body>

    <div id="app" class="mainApp">
        <!-- Top bar -->
        <div class="topbar">
            <h1>    Funkweb CV Portal</h1>
            <button class="topbutton" :class="{selected: !showCV, unselected: showCV}" @click="showCV = false">Home</button>
            <button class="topbutton" :class="{selected: showCV, unselected: !showCV}" @click="showCV = true">My CV</button>
            <div class="rightSide">
                <span v-if="loggedIn">Logged in: {{profile}}</span>
                <button v-if="loggedIn" class="topbutton unselected" @click="logout">Logout</button>
                <button v-else class="topbutton unselected" @click="showLogin = !showLogin">Login</button> 
            </div>
        </div>    
        
        <!-- Login Menu -->
        <div v-if="showLogin" class="login">
            <table>
                <tr>
                    <td class="loginLabel"><b>Email: </b></td>
                    <td><input placeholder="..." v-model:value="profile"></td>
                </tr><tr>
                    <td class="loginLabel"><b>Password: </b></td>
                    <td><input placeholder="..." v-model:value="password" type="password"></td>
                </tr>
            </table><table>
                <tr>
                    <td><button @click="login">Login</button></td>
                    <td><button @click="createProfile">Register</button></td>
                </tr>
            </table>
            <span v-if="error" class="error">Error: {{errorMsg}}</span><span v-else><br></span>
        </div>

        <!-- Left Menu -->
        <div class="left side">
            <div v-if="showCV" class="sideContent">
                <input class="cvNameInput" v-model:value="cvName"></br>
                <table class="sideButtonTable">
                    <tr><td class="sideButtonText">Download</td><td @click="download" class="menuButton"><img src="Icons\download.svg"></td></tr>
                    <tr><td class="sideButtonText">Edit</td><td @click="editMode = !editMode" class="menuButton"><img src="Icons\edit.svg"></td></tr>
                    <tr v-if="loggedIn"><td class="sideButtonText">Save</td><td @click="save(cvName)" class="menuButton"><img src="Icons\save.svg"></td></tr>
                    <tr v-if="loggedIn"><td class="sideButtonText"> Load CV</td><td @click="toggleCVmenu" class="menuButton"><img src="Icons\open.svg"></td></tr>
                </table>
                <div v-if="showCVmenu && loggedIn" class="cvMenu">
                    <template v-for="(item, key) in cvList">
                        <button @click="loadData(item)">{{item}}</button>
                        <span class="delete"><button @click="deleteData(item)">X</button></span>
                    </template>
                    <span v-if="1 > cvList.length">No saved CVs</span>
                    <button v-else @click="deleteAll">Delete All</button>
                </div>
            </div><div v-else>

            </div>
        </div>

        <!-- Right menu -->
        <div class="right side">
            <div v-if="showCV" class="sideContent">
                <b>Font:</b> 
                <select v-model="content.font['font-family']">
                    <option v-for="(font, name) in fonts" 
                    v-bind:value="font">{{name}}</option>
                </select></br>
                <b>Profile image: </b><input v-model:value="content.profileImg">
            </div>      
        </div>

        <!-- Home page -->
        <div v-if="showCV === false" class="center">
            <ul>
                <li>Create and edit your own CV from a template</li>
                <li>Print the CV or download it as pdf</li>
                <li>Save multiple CVs to your profile online</li>
            </ul>
        </div>

        <!-- CV content -->
        <div v-if="showCV" class="center cvContent" id="print">
            <div class="main" v-bind:style="content.font">

                <!-- Name & personal info -->
                <table style="width: 100%"><tr> 
                <td><div class="info">
                    <h2 class="name">
                        <input v-if="editMode" v-model:value="content.name"></input> 
                        <span v-else>{{content.name}}</span>
                    </h2>
                    <table><template v-for="item in content.personInfo">
                        <tr><td>
                            <input v-if="editMode" v-model:value="item.title"></input> 
                            <b v-else>{{item.title}}:</b>
                        </td><td>
                            <input v-if="editMode" v-model:value="item.text"></input> 
                            <span  class="infoText" v-else>{{item.text}}</span>
                        </td></tr>
                    </template></table>
                </div></td><td>
                <div class="profileImg"><img :src="content.profileImg"></div></td>
            </tr></table> 

                <!-- Intro text -->
                <input v-if="editMode" v-model:value="content.intro.title"></input> 
                <b v-else class="headline">{{content.intro.title}}</b></br>
                <textarea v-if="editMode" v-model:value="content.intro.text"></textarea> 
                <span v-else>{{content.intro.text}}</span></h1>
                <span></br></br></span>

                <!-- Education and experience lists -->
                <template v-for="element in content.lists">
                    <span v-if="editMode">
                        <input class="headline" v-if="editMode" v-model:value="element.title">
                        <button v-if="editMode" @click="element.list.unshift(defaultListElement)">Add</button>
                        <button v-if="editMode" @click="element.list.sort(sortListElements)">Sort list</button>
                    </span>

                    <table class="expTable">             
                    <thead v-if="editMode === false"><tr>
                        <th class="duration">
                            <span>{{element.title}}</span>
                        </th>
                        <th class="tableInfo"></th>
                    </tr></thead>

                    <tbody>
                        <template v-for="(item, index) in element.list">
                            <tr v-if="editMode"><td>
                                From:<input type="number" class="monthInput" v-model:value="item.duration.from.month"></input>
                                <input type="number" class="yearInput" v-model:value="item.duration.from.year"></input>
                                To:<input type="number" class="monthInput" v-model:value="item.duration.to.month"></input>
                                <input type="number" class="yearInput" v-model:value="item.duration.to.year"></input>
                                <input v-model:value="item.title"></input>
                                <button v-if="editMode" @click="list.splice(index,1)">Delete</button>
                            </td></tr>
                            <tr v-if="editMode"><textarea v-if="editMode" v-model:value="item.text"></textarea> </tr>
                            <tr v-else>
                                <td>{{getDurationText(item.duration)}}</td>               
                                <td><div class="title">{{item.title}}</div>{{item.text}}</td>
                            </tr>
                        </span></template>
                    </tbody>
                    </table>
                </template></br>

                <!-- Other information -->
                <input v-if="editMode" v-model:value="content.other.title"></input> 
                <b v-else class="headline">{{content.other.title}}</b></br>
                <textarea v-if="editMode" v-model:value="content.other.text"></textarea> 
                <span v-else>{{content.other.text}}</span></h1></br></br>
            </div>
        </div>

    </div>

    <script src="app.js"></script>
</body>
</html>